# HPING3与FPING的使用说明

### **HPING3简介**

hping3是一款免费的数据包生成器和分析器。可用于安全审计、防火墙规则测试、网络测试、端口扫描、性能测试，压力测试(DOS)，几乎可以发送任意类型的TCP/IP数据包。功能强大但是每次只能向一个IP地址发送数据包，还能够在两个相互包含的通道之间传送文件。

### ICMP测试

hping3 -1 192.168.100.105（类似于ping 192.168.100.105）

### 数据包跟踪

hping3 –traceroute -V -1 www.baidu.com

### 端口扫描

#### 单端口扫描

hping3 -I eth0 -p 22 -c 1 -S 192.168.100.104
通过返回包的flag分析端口的状态

#### 多端口扫描

hping3 -8 1-1024 192.168.100.102

### 文件传输

**发送端：**
hping3 -2 -p 1373 192.168.100.102 -d 100 -E test.txt
-2 UDP模式 -p端口
-d 数据大小 -E 文件名

**接收端：**
nc -lp 1373 -u -w 5 > recv.txt && cat recv.txt
-l 监听模式 -p 端口
-w 超时时间 -u UDP模式

### 主机发现

虽然hping3一次只能扫描一个IP，但是我们可以结合shell脚本语言完成整个网段的扫描。下面使用for循环来实现：
for addr in $(seq 1 254); do hping3 192.168.1.$addr -c 1 –icmp & done

for addr in $(seq 1 254);do hping3 192.168.1.$addr -c 1 –icmp >> result2.txt & done

cat result2.txt | grep ^len(通过该命令实现查看存活主机功能，^len表示以len开头的行)

### DOS攻击

#### Syn Flood攻击

hping3 -c 1000 -d 120 -S -p 80 –flood –rand-source 192.168.100.1
-c 指定连接数 -p 目标端口
-d 指定数据部分的大小 -S 攻击类型是Syn flood
–flood 以泛洪的方式攻击
–rand-source 随机产生伪造源地址
hping3 -S -P -U -p 80 –flood –rand-source 192.168.100.1
-P flag置为Push
-U flag置为Urge紧急
加这两参数可以提高效率

#### TCP Flood攻击

使用以下命令建立全连接：
hping3 -SARUPF -p 80 –flood –rand-source 192.168.100.1

#### ICMP Flood攻击

hping3 -q -n -d 200 –icmp –flood -a 11.11.11.11 192.168.100.1
-q安静模式 -n不解析域名 -a指定伪造IP

#### UDP Flood 攻击

hping3 –udp -s 6666 -p 53 -a 8.8.8.8 –flood 192.168.100.1

LAND攻击
hping3 -n -S -p 80 -a 192.168.100.1 –flood 192.168.100.1



### **FPING简介**

Fping程序类似于ping（ping是通过ICMP（网络控制信息协议InternetControl Message Protocol）协议回复请求以检测主机是否存在）。Fping与ping不同的地方在于，fping可以在命令行中指定要ping的主机数量范围，也可以指定含有要ping的主机列表文件。

与ping要等待某一主机连接超时或发回反馈信息不同，fping给一个主机发送完数据包后，马上给下一个主机发送数据包，实现多主机同时ping。如果某一主机ping通，则此主机将被打上标记，并从等待列表中移除，如果没ping通，说明主机无法到达，主机仍然留在等待列表中，等待后续操作。

Fping类似于ping，但比ping强大。Fping与ping不同的地方在于，fping可以在命令行中指定要ping的主机数量范围，也可以指定含有要ping的主机列表文件。
与ping要等待某一主机连接超时或发回反馈信息不同，fping给一个主机发送完数据包后，马上给下一个主机发送数据包，实现多主机同时ping。如果某一主机ping通，则此主机将被打上标记，并从等待列表中移除，如果没ping通，说明主机无法到达，主机仍然留在等待列表中，等待后续操作。

#### fping的命令和参数详解



**−4** , **−−ipv4**

将名称解析和 IP 限制为 IPv4 地址。

**−6** , **−−ipv6**

将名称解析和 IP 限制为 IPv6 地址。

**−a** , −− **活着**

显示活着的系统。

**−A** , −− **地址**

按地址而不是DNS名称显示目标。结合 -d，输出将是 IP 和（如果可用）主机名。

**−b** , **−−size** = *BYTES*

要发送的 ping 数据的字节数。最小大小（通常为 12）为**fping**完成其工作所需的数据（序列号、时间戳）**留出**空间。上报的接收数据大小包括IP头（通常为20字节）和 ICMP头（8字节），所以最小总大小为40字节。默认值为 56，如**ping**。最大值是理论上的最大IP数据报大小 (64K)，尽管大多数系统将其限制为较小的、与系统相关的数字。

**−B** , −− **退避**= *N*

退避因素。在默认模式下，**fping**在放弃之前向目标发送多个请求，等待对每个连续请求的回复的时间更长。此参数是等待时间 ( **-t** ) 乘以每个连续请求的值；它必须作为浮点数 (xy) 输入。默认值为 1.5。

**−c** , **−−count** = *N*

要发送到每个目标的请求数据包数。在这种模式下，为每个收到的响应显示一行（这可以用**-q**或**-Q**抑制 ）。此外，当所有请求都已发送（或中断时）时，会显示每个目标的响应统计信息。

**−C** , **−−vcount** = *N*

与**-c**类似，但每个目标的统计信息以专为自动响应时间统计信息收集设计的格式显示。例如：

```
$ fping −C 5 −q somehost 
 somehost : 91.7 37.0 29.2 − 36.8
```

显示五个请求中每个请求的响应时间（以毫秒为单位），`“-”`表示没有收到对第四个请求的响应。

**−d** , **−−rdns**

使用DNS查找返回 ping 数据包的地址。这允许您为 fping 提供IP地址列表作为输入并在输出中打印主机名。这类似于选项 **-n** / **--name**，但即使您将主机名作为目标（NAME- > IP- > NAME），也会强制进行反向 DNS 查找 。

**−D** , −− **时间戳**

在循环或计数模式（**-l**、**-c**或**-C**）生成的输出行前添加 Unix 时间戳。

**−e** , −− **过去**

显示数据包经过的（往返）时间。

**-f**， **--file**

从文件中读取目标列表。此选项只能由 root 用户使用。普通用户应该通过标准输入管道输入文件：

```
 $ fping <targets_file
```

**−g** , −− **生成** *地址/掩码*

从提供的IP网络掩码或开始和结束 IP生成目标列表。在命令行的目标部分指定网络掩码或开始/结束。如果给出了带有网络掩码的网络，则网络地址和广播地址将被排除。要 ping 网络 192.168.1.0/24，指定的命令行可能如下所示：

```
 $ fping -g 192.168.1.0/24
```

或者

```
 $ fping -g 192.168.1.1 192.168.1.254
```

**-h**， **--help**

打印使用消息。

**−H** , **−−ttl** = *N*

设置IP TTL 字段（存活跳数的时间）。

**−i** , −− **间隔**= *MSEC*

向任何目标发送 ping 数据包之间的最短时间（以毫秒为单位）（默认为 10，最小值为 1）。

**−I** , **−−iface** = *IFACE*

设置接口（需要 SO_BINDTODEVICE支持）。

**−l** , −− **循环**

无限循环地向每个目标发送数据包。可以用 Ctrl-C 中断；然后显示有关每个目标的响应的统计信息。

**-m**， **--all**

向目标主机的多个IP地址中的每一个发送 ping （建议使用选项“-A”）。

**−M** , **−−dontfrag**

在IP标头中设置“Don't Fragment”位（用于确定/测试MTU）。

**-n**， **--name**

如果目标被指定为 IP地址，则对它们执行反向 DNS 查找以

**−N** , −− **网络数据**

网络数据的格式输出（需要 -l -Q）。请参阅：<http://my-netdata.io/>

**−o** , −− **中断**

根据丢失的 ping 次数和使用的间隔（对网络收敛测试有用）计算“中断时间”。

**−O** , **−−tos** = *N*

设置服务标志的类型（ TOS）。*N*可以是十进制或十六进制 (0xh) 格式。

**−p** , −− **期间**= *MSEC*

在循环或计数模式（**-l**、**-c**或**-C**）中，此参数设置**fping** 在到达单个目标的连续数据包之间等待的时间（以毫秒为单位）。默认值为 1000，最小值为 10。

**−q** , **−−quet**

安静的。不要显示每个探针的结果，而只显示最终摘要。也不要显示ICMP错误消息。

**−Q** , **−−squiet** =*秒*

类似于**-q**，但每 n 秒显示一次汇总结果。

**−r** , **−−retry** = *N*

重试限制（默认 3）。这是尝试 ping 目标的次数，不包括第一次尝试。

**−R** , −− **随机**

不是使用全零作为数据包数据，而是生成随机字节。用于破坏，例如，链接数据压缩。

**−s** , **−−src**

退出时打印累积统计信息。

**−S** , **−−src** = *addr*

设置源地址。

**−t** , −− **超时**= *MSEC*

初始目标超时（以毫秒为单位）。在默认的非循环模式下，默认超时为 500 毫秒，它表示**fping**等待对其第一个请求的响应的时间量 。连续超时乘以由**-B**指定的退避因子。

在循环/计数模式下，默认超时会自动调整以匹配“周期”值（但不超过 2000 毫秒）。如果您愿意，您仍然可以使用此选项调整超时值，但请注意，设置大于“期间”的值会产生不一致的结果，因为只有最后一次 ping 才会考虑超时值。

另请注意，任何接收到的大于超时值的回复都将被丢弃。

**−u** , −−未 **达到**

显示无法到达的目标。

**-v** , -- **版本**

打印**fping**版本信息。

